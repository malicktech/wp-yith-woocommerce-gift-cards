!function(g){var a=g("div.gift_card_template_button input[name='quantity']").css("display");g(document.body).on("ywgc_request_window_created",function(){g(".pp_content_container").css("position","fixed"),g(".pp_content_container").css("top","50%"),g(".pp_content_container").css("transform","translateY(-50%)"),g(".pp_content_container").css("max-width","80%"),g(".pp_content_container").css("max-height","100%"),g(".pp_content_container .pp_content").css("max-width","100%"),g(".pp_content_container .pp_content").css("max-height","600px"),g(".pp_content_container .pp_content").css("overflow-y","scroll")}),g(document).ready(function(){jQuery().prettyPhoto&&g('[rel="prettyPhoto[ywgc-choose-design]"]').prettyPhoto({hook:"rel",social_tools:!1,theme:"pp_woocommerce",default_width:"80%",default_height:"100%",horizontal_padding:20,opacity:.8,deeplinking:!1,keyboard_shortcuts:!0,allow_resize:!1,changepicturecallback:function(){g(document.body).trigger("ywgc_request_window_created")}}),g("div.ywgc-generator .datepicker").datepicker({dateFormat:"yy-mm-dd",minDate:1,maxDate:"+1Y"})});var t=function(){g('input[name="ywgc-as-present-enabled"]').length&&(g(".ywgc-generator").hide(),o(!1))};function o(t){g("button.gift_card_add_to_cart_button").attr("disabled",!t)}function e(){var t,e=g(".gift-cards-list select");if(!g("#give-as-present").length){g(".gift-cards-list input.ywgc-manual-amount").addClass("ywgc-hidden"),g(".ywgc-manual-amount-error").remove();var a=0;if(0==e.length||"-1"==e.val()){var c=g(".gift-cards-list input.ywgc-manual-amount");if(c.length){var i=c.val();c.removeClass("ywgc-hidden");var n=new RegExp("^[1-9]\\d*(?:\\"+ywgc_data.currency_format_decimal_sep+"\\d{1,2})?$","g");i.length&&!n.test(i)?(c.after('<div class="ywgc-manual-amount-error">'+ywgc_data.manual_amount_wrong_format+"</div>"),o(!1)):parseInt(i)<parseInt(ywgc_data.manual_minimal_amount)&&0<ywgc_data.manual_minimal_amount_error.length?(c.after('<div class="ywgc-manual-amount-error">'+ywgc_data.manual_minimal_amount_error+"</div>"),o(!1)):i?(o(!0),(a=accounting.unformat(i,ywgc_data.mon_decimal_point))<=0?o(!1):(a=accounting.formatMoney(a,{symbol:ywgc_data.currency_format_symbol,decimal:ywgc_data.currency_format_decimal_sep,thousand:ywgc_data.currency_format_thousand_sep,precision:ywgc_data.currency_format_num_decimals,format:ywgc_data.currency_format}),o(!0))):o(!1)}}else e.val()?(o(!0),a=e.children("option:selected").data("wc-price")):o(!1);t=a,g("div.ywgc-card-amount span.amount").text(t)}}function c(t){g("div.ywgc-card-amount span.amount").html(t)}function l(t,e){var a=g(t).closest("div.ywgc-gift-card-content"),c=a.find("div.ywgc-gift-card-edit-details"),i=a.find("div.ywgc-gift-card-details");e?(c.removeClass("ywgc-hide"),c.addClass("ywgc-show"),i.removeClass("ywgc-show"),i.addClass("ywgc-hide")):(c.removeClass("ywgc-show"),c.addClass("ywgc-hide"),i.removeClass("ywgc-hide"),i.addClass("ywgc-show"))}e(),t(),g("body").on("click",".ywgc-choose-image",function(){g("#ywgc-main-image").attr("src",ywgc_data.loader)}),g(document).on("click",".pp_content_container .ywgc-choose-preset",function(t){var e=g(this).data("design-id"),a=g(this).data("design-url");g("#ywgc-main-image").attr("src",a),g(document).trigger("ywgc-picture-changed",["template",e]),g.prettyPhoto.close()}),g(document).on("click","a.ywgc-show-category",function(t){var e=g(this).data("category-id");return g("a.ywgc-show-category").removeClass("ywgc-category-selected"),g(this).addClass("ywgc-category-selected"),"all"!==e?(g(".ywgc-design-item").hide(),g(".ywgc-design-item."+e).show()):g(".ywgc-design-item").show(),!1}),g(document).on("ywgc-picture-changed",function(t,e,a){g("#ywgc-design-type").val(e),g("#ywgc-template-design").val(a)}),g(document).on("click","a.ywgc-show-giftcard",function(){return g(".ywgc_enter_code").slideToggle(300,function(){g(".yith_wc_gift_card_blank_brightness").length||(g(".ywgc_enter_code").find(":input:eq( 0 )").focus(),g(".ywgc_enter_code").keyup(function(t){13===t.keyCode&&g("input[ name='ywgc_apply_gift_card' ]").click()}))}),!1}),g("button.ywgc-do-edit").css("display","inline"),g(document).on("input",".gift-cards-list input.ywgc-manual-amount",function(t){e()}),g(document).on("click","a.add-recipient",function(t){var e,a,c;t.preventDefault(),e=g("div.ywgc-single-recipient").last(),a=ywgc_data.mandatory_email?"required":"",c='<div class="ywgc-single-recipient"><input type="email" name="ywgc-recipient-email[]" class="ywgc-recipient yith_wc_gift_card_input_recipient_details" placeholder="'+ywgc_data.email+'" '+a+'/><input type="text" name="ywgc-recipient-name[]" class="yith_wc_gift_card_input_recipient_details" placeholder="'+ywgc_data.name+'" '+a+'/><a href="#" class="ywgc-remove-recipient">x</a> </div>',e.after(c),g("a.ywgc-remove-recipient").css("visibility","visible"),g("div.gift_card_template_button input[name='quantity']").css("display","none"),g("div.gift_card_template_button div.ywgc-multi-recipients").length||g("div.gift_card_template_button div.quantity").after("<div class='ywgc-multi-recipients'><span>"+ywgc_data.multiple_recipient+"</span></div>")}),g(document).on("click","a.add-physical-recipient",function(t){var e,a,c;t.preventDefault(),e=g("div.ywgc-single-recipient").last(),a=ywgc_data.mandatory_email?"required":"",c='<div class="ywgc-single-recipient"><input type="text" name="ywgc-recipient-name[]" class="ywgc-recipient yith_wc_gift_card_input_recipient_details" placeholder="'+ywgc_data.name+'" '+a+'/><a href="#" class="ywgc-remove-recipient">x</a> </div>',e.after(c),g("a.ywgc-remove-recipient").css("visibility","visible"),g("div.gift_card_template_button input[name='quantity']").css("display","none"),g("div.gift_card_template_button div.ywgc-multi-recipients").length||g("div.gift_card_template_button div.quantity").after("<div class='ywgc-multi-recipients'><span>"+ywgc_data.multiple_recipient+"</span></div>")}),g(document).on("click","a.ywgc-remove-recipient",function(t){var e;t.preventDefault(),e=g(this),g(e).parent("div.ywgc-single-recipient").remove(),1==g('input[name="ywgc-recipient-email[]"]').length&&(g("a.hide-if-alone").css("visibility","hidden"),g("div.gift_card_template_button input[name='quantity']").css("display",a),g("div.ywgc-multi-recipients").remove())}),g(document).on("input","#ywgc-edit-message",function(t){g(".ywgc-card-message").html(g("#ywgc-edit-message").val())}),g(document).on("change",".gift-cards-list select",function(t){e()}),g(document).on("click","a.customize-gift-card",function(t){t.preventDefault(),g("div.summary.entry-summary").after('<div class="ywgc-customizer"></div>')}),g(document).on("click",".ywgc-default-picture",function(t){t.preventDefault();var e=g("#ywgc-upload-picture");e.replaceWith(e=e.clone(!0)),g(".ywgc-main-image img.ywgc-main-image").attr("src",ywgc_data.default_gift_card_image),g(".ywgc-main-image").css("background-color",""),g("div.gift-card-too-small").remove(),g(document).trigger("ywgc-picture-changed",["default"])}),g(".yith-wcpb-product-bundled-items").length&&setTimeout(function(){g("#give-as-present").prop("disabled",!1)},1e3),g("body").on("click",".ywgc-product-picture",function(){var t=g("body .single_add_to_cart_button").next();if("product_id"==g(t).attr("name"))var e=g(t).val();else{t=g(t).next();if("product_id"==g(t).attr("name"))e=g(t).val();else e=g("body .single_add_to_cart_button").val()}var a,c,i,n=0;if(g("body .single_add_to_cart_button").parent().find("input[ name=variation_id ]").length)n=g("body .single_add_to_cart_button").parent().find("input[ name=variation_id ]").val();if(g(".yith-wcpb-product-bundled-items").length)e=g(".yith-wcpb-bundle-form").find("input[ name=add-to-cart ]").val();ywgc_data,a={action:"yith_wc_gift_card_ajax_replace_for_product_image",product_id:e,variation_id:n},c="#yith_wc_gift_card_ajax_replace_for_product_image",i="<h1>WAITING</h1>",g.ajax({data:a,url:ywgc_data.ajax_url,type:"post",beforeSend:function(){g(c).html(i)},error:function(t){console.log("yith_wc_gift_card_ajaxGo ajax error -> "+t)},success:function(t){g(c).html(t)}}),g(document).trigger("ywgc-picture-changed",["product_image"])}),g(document).on("click",".ywgc-custom-picture",function(t){g("#ywgc-upload-picture").click()}),g("#ywgc-upload-picture").on("change",function(){g(".ywgc-picture-error").remove();var t,e,a=g(this).val().split(".").pop().toLowerCase();-1!=g.inArray(a,["gif","png","jpg","jpeg","bmp"])?g(this)[0].files[0].size>1024*ywgc_data.custom_image_max_size*1024&&0<ywgc_data.custom_image_max_size?g("div.gift-card-content-editor.step-appearance").append('<span class="ywgc-picture-error">'+ywgc_data.invalid_image_size+"</span>"):(t=g(this)[0].files[0],(e=new FileReader).readAsDataURL(t),e.onload=function(t){document.getElementById("ywgc-main-image").src=t.target.result,g(document).trigger("ywgc-picture-changed",["custom"]),g("#ywgc-main-image").width()<g(".ywgc-main-image").width()?(g(".ywgc-main-image").css("background-color","#ffe326"),g(".ywgc-preview").prepend('<div class="gift-card-too-small">'+ywgc_data.notify_custom_image_small+"</div>")):g(".ywgc-main-image").css("background-color","")}):g("div.gift-card-content-editor.step-appearance").append('<span class="ywgc-picture-error">'+ywgc_data.invalid_image_extension+"</span>")}),g(document).on("click","#give-as-present",function(t){t.preventDefault(),g("#give-as-present").css("display","none"),g("div.ywgc-generator").append('<input type="hidden" name="ywgc-as-present" value="1">'),g(".woocommerce-variation-add-to-cart").length?g("div.ywgc-generator").insertBefore(g(".woocommerce-variation-add-to-cart ")):g("div.ywgc-generator").prependTo(g("form.cart")),g("button.single_add_to_cart_button").data("add-to-cart-text",g("button.single_add_to_cart_button").text()),g("button.single_add_to_cart_button").html(ywgc_data.add_gift_text),g("#ywgc-cancel-gift-card").css("display","inline-block"),g("div.ywgc-generator").css("display","block"),g(".yith-wcpb-product-bundled-items").length&&("yes"==g("#yith_wcyc_automatically_gift_this_product").val()?g(".ywgc-template").before(g(".yith-wcpb-product-bundled-items")):(g(".single_add_to_cart_button").after(g(".yith-wcpb-product-bundled-items")),g(".single_add_to_cart_button").css("margin-bottom","20px")))}),g(document).on("click","#ywgc-cancel-gift-card",function(t){t.preventDefault(),g("div.ywgc-generator input[name='ywgc-as-present']").remove(),g("button.single_add_to_cart_button").html(g("button.single_add_to_cart_button").data("add-to-cart-text")),g("#give-as-present").css("display","inline-block"),g("#ywgc-cancel-gift-card").css("display","none"),g("div.ywgc-generator").css("display","none")}),g(document).on("change","#ywgc-postdated",function(t){g(this).is(":checked")?g("#ywgc-delivery-date").removeClass("ywgc-hidden"):g("#ywgc-delivery-date").addClass("ywgc-hidden")}),g(".variations_form.cart").on("found_variation",function(t,e){void 0!==e&&(g("#give-as-present").prop("disabled",!1),c(""!=e.price_html?g(e.price_html).html():g(".product-type-variable").find(".woocommerce-Price-amount.amount").first().html()))}),g(document).on("reset_data",function(){g("#give-as-present").prop("disabled",!0),c("")}),g(document).on("click","button.ywgc-apply-edit",function(t){var e=g(this),a=e.closest("div.ywgc-gift-card-content"),c=a.find('input[name="ywgc-edit-sender"]').val(),i=a.find('input[name="ywgc-edit-recipient"]').val(),n=a.find('textarea[name="ywgc-edit-message"]').val(),o=a.find('input[name="ywgc-item-id"]').val(),d=a.find('input[name="ywgc-gift-card-id"]'),r=d.val();if(e.hasClass("apply")){var s={action:"edit_gift_card",gift_card_id:r,item_id:o,sender:c,recipient:i,message:n};a.block({message:null,overlayCSS:{background:"#fff url("+ywgc_data.loader+") no-repeat center",opacity:.6}}),g.post(ywgc_data.ajax_url,s,function(t){0<t.code&&(a.find("span.ywgc-sender").text(c),a.find("span.ywgc-recipient").text(i),a.find("span.ywgc-message").text(n),2==t.code&&d.val(t.values.new_id)),a.unblock(),l(e,!1)})}}),g(document).on("click","button.ywgc-cancel-edit",function(t){l(g(this),!1)}),g(document).on("click","button.ywgc-do-edit",function(t){l(g(this),!0)}),g(document).on("click","form.gift-cards_form button.gift_card_add_to_cart_button",function(t){g("div.gift-card-content-editor.step-content p.ywgc-filling-error").remove(),g("#ywgc-postdated").is(":checked")&&!g.datepicker.parseDate("yy-mm-dd",g("#ywgc-delivery-date").val())&&(g("div.gift-card-content-editor.step-content").append('<p class="ywgc-filling-error">'+ywgc_data.missing_scheduled_date+"</p>"),t.preventDefault())}),g(document).on("click",".ywgc-gift-card-content a.edit-details",function(t){t.preventDefault(),g(this).addClass("ywgc-hide"),g("div.ywgc-gift-card-details").toggleClass("ywgc-hide")}),g('.ywgc-single-recipient input[name="ywgc-recipient-email[]"]').each(function(t,e){g(this).on("input",function(){g(this).closest(".ywgc-single-recipient").find(".ywgc-bad-email-format").remove()})}),g(document).on("submit",".gift-cards_form",function(t){var c=!0;g('.ywgc-single-recipient input[name="ywgc-recipient-email[]"]').each(function(t,e){var a;g(this).val()&&(a=g(this).val(),!new RegExp("^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}$","i").test(a))&&(g(this).closest(".ywgc-single-recipient").find(".ywgc-bad-email-format").remove(),g(this).after('<span class="ywgc-bad-email-format">'+ywgc_data.email_bad_format+"</span>"),c=!1)}),c||t.preventDefault()}),g(document).on("click","a.ywgc-remove-gift-card ",function(t){t.preventDefault();var e=g(t.currentTarget).parents("table"),a=g(t.currentTarget).data("gift-card-code");n(e);var c={security:ywgc_data.gift_card_nonce,code:a,action:"ywgc_remove_gift_card_code"};g.ajax({type:"POST",url:ywgc_data.ajax_url,data:c,dataType:"html",success:function(t){r(t),g(document.body).trigger("removed_gift_card"),d(e)},complete:function(){s()}})}),g(document).on("click",'input[ name="ywgc_apply_gift_card" ]',function(t){t.preventDefault();var e=g(this).closest("div.ywgc_enter_code");n(e);var a=e.find('input[ name="gift_card_code" ]'),c=a.val(),i={security:ywgc_data.gift_card_nonce,code:c,action:"ywgc_apply_gift_card_code"};g.ajax({type:"POST",url:ywgc_data.ajax_url,data:i,dataType:"html",success:function(t){r(t),g(document.body).trigger("applied_gift_card")},complete:function(){d(e),a.val(""),s()}})});var n=function(t){t.addClass("processing").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},d=function(t){t.removeClass("processing").unblock()},i=function(t){return ywgc_data.wc_ajax_url.toString().replace("%%endpoint%%",t)},r=function(t){g(".woocommerce-error, .woocommerce-message").remove(),g(ywgc_data.notice_target).after(t),g(".ywgc_have_code").length&&g(".ywgc_enter_code").slideUp("300")};function s(){n(g("div.cart_totals")),g.ajax({url:i("get_cart_totals"),dataType:"html",success:function(t){g("div.cart_totals").replaceWith(t)}}),g(document.body).trigger("update_checkout")}g(document).on("qv_loader_stop yit_quick_view_loaded flatsome_quickview",function(){e(),t()}),"yes"==ywgc_data.gift_amounts_select2&&g("#gift_amounts").select2(),"yes"==g("#yith_show_gift_this_product_form").val()&&g("#give-as-present").click(),"yes"==g("#yith_wcyc_automatically_gift_this_product").val()&&(g("#give-as-present").click(),g(".ywgc-product-picture").click())}(jQuery);